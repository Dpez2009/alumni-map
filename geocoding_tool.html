<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Batch Geocoding Tool | Get LngLat Coordinates for Places</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.0/jquery.min.js"></script>
  <link href='https://api.mapbox.com/mapbox-assembly/v1.3.0/assembly.min.css' rel='stylesheet'>
  <script src='https://api.mapbox.com/mapbox-assembly/v1.3.0/assembly.js'></script>
  <style>
    #results td {
      white-space: nowrap;
    }
  </style>
</head>

<body>
  <table id="results" class="table">
    <thead>
      <tr>
        <th>name</th>
        <th>longitude</th>
        <th>latitude</th>
        <th>street</th>
        <th>city</th>
        <th>state</th>
        <th>zip</th>
        <th>country</th>
        <th>category</th>
        <th>county</th>
      </tr>
    </thead>
  </table>
  <script>
    // Initialize constants for the API request:
    const urlBase = 'https://api.mapbox.com/geocoding/v5/mapbox.places/'
    const token = 'pk.eyJ1IjoiZG9tbGV0IiwiYSI6ImNsaTN5MXhseTA0bWMzZHBoNTlnaG1hYmUifQ.9IpTpyptAxhC6ZoUqKCd9w' // Restricted token

    /* 
    See this example `queries`  array with 2 example strings:
    let queries = [
      'Allen+University+Columbia+South+Carolina+USA',
      'Edward+Waters+University+Jacksonville+Florida+USA',
    ]
    */

    // Use the same format as examples ^ above to add
    // your strings inside the `queries` array below.
    // (If characters like apostrophes cause problems, delete them.)
    let queries = [
      'ALLAN+HANCOCK+COLLEGE+800+South+College+Drive',
      'AMERICAN+RIVER+COLLEGE+4700+College+Oak+Drive',
      'ANTELOPE+VALLEY+COLLEGE+3041+West+Avenue+K',
      'BUTTE+COLLEGE+3536+Butte+Campus+Drive',
      'CABRILLO+COLLEGE+6500+Soquel+Drive',
      'CAÃ‘ADA+COLLEGE+4200+Farm+Hill+Boulevard',
      'CERRITOS+COLLEGE+11110+Alondra+Boulevard',
      'CHABOT+COLLEGE+25555+Hesperian+Boulevard',
      'CHAFFEY+COLLEGE+5885+Haven+Avenue',
      'CITRUS+COLLEGE+1000+West+Foothill+Boulevard',
      'COLLEGE+OF+THE+CANYONS+26455+N.+Rockwell+Canyon+Road',
      'COLUMBIA+COLLEGE+11600+Columbia+College+Drive',
      'COMPTON+COLLEGE+1111+E.+Artesia+Boulevard',
      'CONTRA+COSTA+COLLEGE+2600+Mission+Bell+Drive',
      'COPPER+MOUNTAIN+COLLEGE+6162+Rotary+Way',
      'CRAFTON+HILLS+COLLEGE+11711+Sand+Canyon+Road',
      'CUESTA+COLLEGE+PO+Box+8106',
      'CUYAMACA+COLLEGE+900+Rancho+San+Diego+Parkway',
      'CYPRESS+COLLEGE+9200+Valley+View+Street',
      'DEANZA+COLLEGE+21250+Stevens+Creek+Boulevard',
      'EAST+LOS+ANGELES+COLLEGE+1301+Avenida+Cesar+Chavez',
      'FOLSOM+LAKE+COLLEGE+10+College+Parkway',
      'FOOTHILL+COLLEGE+12345+El+Monte+Road',
      'FRESNO+CITY+COLLEGE+1101+E.+University+Avenue',
      'FULLERTON+COLLEGE+321+East+Chapman+Avenue',
      'GAVILAN+COLLEGE+5055+Santa+Teresa+Boulevard',
      'GOLDEN+WEST+COLLEGE+15744+Goldenwest+Street',
      'HARTNELL+COLLEGE+156+Homestead+Avenue',
      'IMPERIAL+VALLEY+COLLEGE+380+East+Aten+Road',
      'IRVINE+VALLEY+COLLEGE+5500+Irvine+Center+Drive',
      'LAS+POSITAS+COLLEGE+3000+Campus+Hill+Drive',
      'LASSEN+COLLEGE+PO+Box+3000',
      'LONG+BEACH+CITY+COLLEGE+4901+East+Carson+Street',
      'LOS+ANGELES+CITY+COLLEGE+855+North+Vermont+Avenue',
      'LOS+ANGELES+HARBOR+COLLEGE+1111+Figueroa+Place',
      'LOS+ANGELES+MISSION+COLLEGE+13356+Eldridge+Avenue',
      'LOS+ANGELES+PIERCE+COLLEGE+6201+Winnetka+Avenue',
      'LOS+ANGELES+SOUTHWEST+COLLEGE+1600+West+Imperial+Highway',
      'LOS+ANGELES+TRADE-TECH+COLLEGE+400+West+Washington+Boulevard',
      'MADERA+COLLEGE+30277+Avenue+12',
      'MENDOCINO+COLLEGE+1000+Hensley+Creek+Road',
      'MERCED+COLLEGE+3600+M+Street',
      'MERRITT+COLLEGE+12500+Campus+Drive',
      'MIRACOSTA+COLLEGE+1+Barnard+Drive',
      'MISSION+COLLEGE+3000+Mission+College+Boulevard',
      'MONTEREY+PENINSULA+COLLEGE+980+Fremont+Street',
      'MORENO+VALLEY+COLLEGE+16130+Lasselle+Street',
      'NAPA+VALLEY+COLLEGE+2277+Napa+Vallejo+Highway',
      'OHLONE+COLLEGE+43600+Mission+Boulevard',
      'ORANGE+COAST+COLLEGE+PO+Box+5005',
      'OXNARD+COLLEGE+4000+South+Rose+Avenue',
      'PALO+VERDE+COLLEGE+One+College+Drive',
      'PALOMAR+COLLEGE+1140+West+Mission+Road',
      'PORTERVILLE+COLLEGE+100+East+College+Avenue',
      'RIO+HONDO+COLLEGE+3600+Workman+Mill+Road',
      'RIVERSIDE+CITY+COLLEGE+4800+Magnolia+Avenue',
      'SACRAMENTO+CITY+COLLEGE+3835+Freeport+Boulevard',
      'SADDLEBACK+COLLEGE+28000+Marguerite+Parkway',
      'SAN+DIEGO+CITY+COLLEGE+1313+Park+Boulevard',
      'SAN+DIEGO+MESA+COLLEGE+7250+Mesa+College+Drive',
      'SAN+DIEGO+MIRAMAR+COLLEGE+10440+Black+Mountain+Road',
      'SAN+JOSE+CITY+COLLEGE+2100+Moorpark+Avenue',
      'SANTA+ANA+COLLEGE+1530+W.+17th+Street',
      'SANTA+BARBARA+CITY+COLLEGE+721+Cliff+Drive',
      'SANTA+MONICA+COLLEGE+1900+Pico+Boulevard',
      'SANTA+ROSA+JUNIOR+COLLEGE+1501+Mendocino+Avenue',
      'SANTIAGO+CANYON+COLLEGE+8045+E.+Chapman+Avenue',
      'SIERRA+COLLEGE+5000+Rocklin+Road',
      'SKYLINE+COLLEGE+3300+College+Drive',
      'SOLANO+COMMUNITY+COLLEGE+4000+Suisun+Valley+Road',
      'SOUTHWESTERN+COLLEGE+900+Otay+Lakes+Road',
      'TAFT+COLLEGE+29+Cougar+Ct.',
      'VICTOR+VALLEY+COLLEGE+18422+Bear+Valley+Road',
      'WEST+HILLS+COLLEGE+COALINGA+300+Cherry+Lane',
      'WEST+HILLS+COLLEGE+LEMOORE+555+College+Avenue',
      'WEST+LOS+ANGELES+COLLEGE+9000+Overland+Avenue',
      'WEST+VALLEY+COLLEGE+14000+Fruitvale+Avenue',
      'YUBA+COLLEGE+2088+North+Beale+Road',
      'CALBRIGHT+COLLEGE+-',
    ]
    // Define the function, including the loop:
    async function makeGeoRequest(i) {
      const query = await fetch(
        `https://api.mapbox.com/geocoding/v5/mapbox.places/${queries[i]}.json?limit=1&access_token=pk.eyJ1IjoiZG9tbGV0IiwiYSI6ImNsanp3a24xeDAxMjMzZGxpeDY3MWZpMXkifQ.4TIVDbum8xmIdzokCod3Ww`,
        { method: 'GET' }
      );
      console.log('i made an api request')
      const data = await query.json();
      let name = data.features[0].text // name
      let lng = data.features[0].center[0] // lng
      let lat = data.features[0].center[1] // lat
      let street = data.features[0].properties.address // street
      let city = data.features[0].context[1].text // city
      let state = data.features[0].context[3].text // state
      let zip = data.features[0].context[0].text // zip
      let country = data.features[0].context[4].text // country
      let category = data.features[0].properties.category // category
      let county = data.features[0].context[2].text // county
      console.log(name + lng + lat + street + city + state + zip + country + category + county)
      // Create HTML elements:
      let html = `<td>${name}</td>
      <td>${lng}</td>
      <td>${lat}</td>
      <td>${street}</td>
<!-- <td>${city}</td>
      <td>${state}</td>
      <td>${zip}</td>
      <td>${country}</td>
      <td>${category}</td>
      <td>${county}</td>-->`

      let row = document.createElement('tr'); // create a row
      resultsTable.appendChild(row); // add it to the table
      let rowId = 'row' + i // create a unique id
      row.setAttribute('id', rowId) // attach the unique id
      document.getElementById(rowId).innerHTML = html
    }

    // Create the loop, and call the function:
    const resultsTable = document.getElementById("results");
    for (i in queries) {
      makeGeoRequest(i)
    }

    // async function geoRequest() {
    //   for (i in queries) {
    //     item = queries[i]
    //     const query = await fetch(
    //       `${api}${item}${token}`,
    //       { method: 'GET' }
    //     );
    //     // // do something with the api response:
    //     const data = await query.json();
    //     for (i in data.features[0]) {
    //       console.log(i)
    //       console.log(data.features[0].i)
    //     }
    //     let text = data.features[0].text
    //     let address = data.features[0].properties.address
    //     let center = data.features[0].center
    //     let place_name = data.features[0].place_name
    //     let category = data.features[0].properties.category

    //   }
    // }



  </script>
</body>

</html>